(function(x,G){x.qwertyHancock=function(c){var a=c.id||"keyboard",y=7*(c.octaves||3),z=c.width||600,A=c.height||150,l=c.startNote||"A3",g=l.charAt(1),v=c.whiteNotesColour||"#FFF",w=c.blackNotesColour||"#000",r=c.hoverColour||"#076cf0",s=z/y,D=s/2;c=c.keyboardLayout||"en";var E=new Raphael(a,z,A),t="CDEFGAB".split(""),F=["A","C","D","F","G"],f=0,u=l.charAt(0),l=g,m=!1,p,q,B={},d=[],h=[],n=[];document.getElementById(a).style.fontSize="0px";for(var e=function(a){var b;b=3===a.length?a.charAt(2):a.charAt(1);
a="A A# B C C# D D# E F F# G G#".split(" ").indexOf(a.slice(0,-1));return 440*Math.pow(2,((3>a?a+12+12*(b-1)+1:a+12*(b-1)+1)-49)/12)},a=0;7>a;a++)if(u===t[a]){keyOffset=a;break}for(a=0;7>a;a++)n[a]=6<a+keyOffset?t[a+keyOffset-7]:t[a+keyOffset];for(a=0;a<y;a++)0===a%t.length&&(f=0),u=n[f],"C"===u&&l++,d[a]=E.rect(s*a,0,s,A).attr({id:n[f],title:n[f]+(l-1),fill:v}).mousedown(function(){m=!0;this.attr({fill:r});p(this.attr("title"),e(this.attrs.title))}).mouseover(function(){m&&(this.attr({fill:r}),p(this.attr("title"),
e(this.attrs.title)))}).mouseup(function(){this.attr({fill:v});m=!1;q(this.attr("title"),e(this.attrs.title))}).mouseout(function(){m&&(this.attr({fill:v}),q(this.attr("title"),e(this.attrs.title)))}),f++;l=g;for(a=0;a<y;a++){0===a%t.length&&(f=0);for(var C=0;C<F.length;C++)n[f]===F[C]&&(u=n[f]+"#","C#"===u&&l++,s*(a+1)<z&&(h[a]=E.rect(s*a+1.5*D,0,D,2*(A/3)).attr({id:n[f],title:n[f]+"#"+(l-1),fill:w}).mousedown(function(){m=!0;this.attr({fill:r});p(this.attr("title"),e(this.attrs.title))}).mouseover(function(){m&&
(this.attr({fill:r}),p(this.attr("title"),e(this.attrs.title)))}).mouseup(function(){this.attr({fill:w});m=!1;q(this.attr("title"),e(this.attrs.title))}).mouseout(function(){m&&(this.attr({fill:w}),q(this.attr("title"),e(this.attrs.title)))})));f++}if("en"==c)var k={65:"Cl",87:"C#l",83:"Dl",69:"D#l",68:"El",70:"Fl",84:"F#l",71:"Gl",89:"G#l",72:"Al",85:"A#l",74:"Bl",75:"Cu",79:"C#u",76:"Du",80:"D#u",186:"Eu",222:"Fu",221:"F#u",220:"Gu"};else"de"==c&&(k={65:"Cl",87:"C#l",83:"Dl",69:"D#l",68:"El",70:"Fl",
84:"F#l",71:"Gl",90:"G#l",72:"Al",85:"A#l",74:"Bl",75:"Cu",79:"C#u",76:"Du",80:"D#u",186:"Eu",222:"Fu",221:"F#u",220:"Gu"});x.onkeydown=function(a){if(!(a.keyCode in B)){B[a.keyCode]=!0;for(var b=0;b<d.length;b++)if("undefined"!==typeof k[a.keyCode]&&"undefined"!==typeof d[b]){var c=k[a.keyCode].replace("l",g).replace("u",(parseInt(g,10)+1).toString());d[b].attrs.title===c&&(d[b].attr({fill:r}),p(d[b].attrs.title,e(d[b].attrs.title)))}for(b=0;b<h.length;b++)"undefined"!==typeof k[a.keyCode]&&"undefined"!==
typeof h[b]&&(c=k[a.keyCode].replace("l",g).replace("u",(parseInt(g,10)+1).toString()),h[b].attrs.title===c&&(h[b].attr({fill:r}),p(c,e(c))))}};x.onkeyup=function(a){delete B[a.keyCode];for(var b=0;b<d.length;b++)if("undefined"!==typeof k[a.keyCode]&&"undefined"!==typeof d[b]){var c=k[a.keyCode].replace("l",g).replace("u",(parseInt(g,10)+1).toString());d[b].attrs.title===c&&(d[b].attr({fill:v}),q(d[b].attrs.title,e(d[b].attrs.title)))}for(b=0;b<h.length;b++)"undefined"!==typeof k[a.keyCode]&&"undefined"!==
typeof h[b]&&(c=k[a.keyCode].replace("l",g).replace("u",(parseInt(g,10)+1).toString()),h[b].attrs.title===c&&(h[b].attr({fill:w}),q(c,e(c))))};return{keyDown:function(a){p=a},keyUp:function(a){q=a}}}})(window);
